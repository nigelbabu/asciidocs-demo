<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Gluster User Documentation Latest | Gluster Docs Project | Distributed Geo Replication</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <link href="../../latest/_stylesheets/asciibinder.css" rel="stylesheet" />

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="../../latest/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="../../latest/_images/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="http://www.asciibinder.org/"><img alt="AsciiBinder" src="../../latest/_images/asciibinder-logo-horizontal.png"></a>
      </div>
    </div>
  </div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../index.html">Home</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster User Documentation Latest</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster Docs Project</a>
      </li>
      
      <li class="hidden-xs active">
        Distributed Geo Replication
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Gluster Docs Project
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../admin-guide/index.html">Index</a></li>
            <li><a class="" href="../admin-guide/access-control-lists.html">Access Control Lists</a></li>
            <li><a class="" href="../admin-guide/accessing-gluster-from-windows.html">Accessing Gluster from Windows</a></li>
            <li><a class="" href="../admin-guide/arbiter-volumes-and-quorum.html">Arbiter-volumes and Quorum</a></li>
            <li><a class="" href="../admin-guide/bareos.html">BareOS</a></li>
            <li><a class="" href="../admin-guide/brick-naming-conventions.html">Brick naming conventions</a></li>
            <li><a class="" href="../admin-guide/building-qemu-with-gfapi-for-debian-based-systems.html">Building QEMU with gfapi for Debian-based systems</a></li>
            <li><a class="" href="../admin-guide/cinder.html">Cinder</a></li>
            <li><a class="" href="../admin-guide/Console.html">Console</a></li>
            <li><a class="" href="../admin-guide/compiling-rpms.html">Compiling RPMs</a></li>
            <li><a class="" href="../admin-guide/coreutils.html">Coreutils</a></li>
            <li><a class="" href="../admin-guide/did-you-know.html">Did you know</a></li>
            <li><a class="" href="../admin-guide/directory-quota.html">Diectory Quota</a></li>
            <li><a class=" active" href="../admin-guide/distributed-geo-replication.html">Distributed Geo Replication</a></li>
            <li><a class="" href="../admin-guide/export-and-netgroup-authentication.html">Export and netgroup authentication</a></li>
            <li><a class="" href="../admin-guide/filter.html">Filter</a></li>
            <li><a class="" href="../admin-guide/geo-replication.html">Geo Replication</a></li>
            <li><a class="" href="../admin-guide/glossary.html">Glossary</a></li>
            <li><a class="" href="../admin-guide/gluster-on-zfs.html">Gluster on ZFS</a></li>
            <li><a class="" href="../admin-guide/Hadoop.html">Hadoop</a></li>
            <li><a class="" href="../admin-guide/Handling-of-users-with-many-groups.html">Handling of users with many groups</a></li>
            <li><a class="" href="../admin-guide/introduction.html">Introduction</a></li>
            <li><a class="" href="../admin-guide/iscsi.html">iSCSI</a></li>
            <li><a class="" href="../admin-guide/keystore-quickstart.html">Keystore Quickstart</a></li>
            <li><a class="" href="../admin-guide/linux-kernel-tuning.html">Linux Kernel Tuning</a></li>
            <li><a class="" href="../admin-guide/logging.html">Logging</a></li>
            <li><a class="" href="../admin-guide/managing-snapshots.html">Managing snapshots</a></li>
            <li><a class="" href="../admin-guide/managing-volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../admin-guide/mandatory-locks.html">Mandatory Locks</a></li>
            <li><a class="" href="../admin-guide/monitoring-workload.html">Monitoring Workload</a></li>
            <li><a class="" href="../admin-guide/network-configuration-techniques.html">Network Configuration Techniques</a></li>
            <li><a class="" href="../admin-guide/nfs-ganesha-integration.html">NFS-Ganesha Integration</a></li>
            <li><a class="" href="../admin-guide/object-storage.html">Object storage</a></li>
            <li><a class="" href="../admin-guide/performance-testing.html">Performance Testing</a></li>
            <li><a class="" href="../admin-guide/Puppet.html">Puppet</a></li>
            <li><a class="" href="../admin-guide/rdma-transport.html">RDMA Transport</a></li>
            <li><a class="" href="../admin-guide/resolving-peer-rejected.html">Resolving Peer Rejected</a></li>
            <li><a class="" href="../admin-guide/setting-up-clients.html">Setting up Clients</a></li>
            <li><a class="" href="../admin-guide/setting-up-volumes.html">Setting up volumes</a></li>
            <li><a class="" href="../admin-guide/ssl.html">SSL</a></li>
            <li><a class="" href="../admin-guide/start-stop-daemon.html">Start Stop Daemon</a></li>
            <li><a class="" href="../admin-guide/storage-pools.html">Storage Pools</a></li>
            <li><a class="" href="../admin-guide/trash.html">Trash</a></li>
            <li><a class="" href="../admin-guide/troubleshooting.html">Troubleshooting</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Distributed Geo-Replication in glusterfs-3.5</h2>
        </div>
        <div class="sect1">
<h2 id="distributed-geo-replication-in-glusterfs-3.5"><a class="anchor" href="#distributed-geo-replication-in-glusterfs-3.5"></a>Distributed Geo-Replication in glusterfs-3.5</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a admin how-to guide for new dustributed-geo-replication being
released as part of glusterfs-3.5</p>
</div>
<div id="note" class="paragraph">
<p>Note:</p>
</div>
<div class="paragraph">
<p>This article is targeted towards users/admins who want to try new
geo-replication, without going much deeper into internals and technology
used.</p>
</div>
<div class="sect3">
<h4 id="how-is-it-different-from-earlier-geo-replication"><a class="anchor" href="#how-is-it-different-from-earlier-geo-replication"></a>How is it different from earlier geo-replication?</h4>
<div class="ulist">
<ul>
<li>
<p>Up until now, in geo-replication, only one of the nodes in master
volume would participate in geo-replication. This meant that all the
data syncing is taken care by only one node while other nodes in the
cluster would sit idle (not participate in data syncing). With
distributed-geo-replication, each node of the master volume takes the
repsonsibility of syncing the data present in that node. In case of
replicate configuration, one of them would 'Active&#8217;ly sync the data
while other node of the replica pair would be 'Passive'. The 'Passive'
node only becomes 'Active' when the 'Active' pair goes down. This way
new geo-rep leverages all the nodes in the volume and remove the
bottleneck of syncing from one single node.</p>
</li>
<li>
<p>New change detection mechanism is the other thing which has been
improved with new geo-rep. So far geo-rep used to crawl through
glusterfs file system to figure out the files that need to synced. And
because crawling filesystem can be an expensive operation, this used to
be a major bottleneck for performance. With distributed geo-rep, all the
files that need to be synced are identified through changelog xlator.
Changelog xlator journals all the fops that modifes the file and these
journals are then consumed by geo-rep to effectively identify the files
that need to be synced.</p>
</li>
<li>
<p>A new syncing method tar+ssh, has been introduced to improve the
performance of few specific data sets. You can switch between rsync and
tar+ssh syncing method via CLI to suite your data set needs. This
tar+ssh is better suited for data sets which have large number of small
files.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="using-distributed-geo-replication"><a class="anchor" href="#using-distributed-geo-replication"></a>Using Distributed geo-replication:</h4>
<div class="sect4">
<h5 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites:</h5>
<div class="ulist">
<ul>
<li>
<p>There should be a password-less ssh setup between at least one node in
master volume to one node in slave volume. The geo-rep create command
should be executed from this node which has password-less ssh setup to
slave.</p>
</li>
<li>
<p>Unlike previous version, slave <strong>must</strong> be a gluster volume. Slave can
not be a directory. And both the master and slave volumes should have
been created and started before creating geo-rep session.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="creating-secret-pem-pub-file"><a class="anchor" href="#creating-secret-pem-pub-file"></a>Creating secret pem pub file</h5>
<div class="ulist">
<ul>
<li>
<p>Execute the below command from the node where you setup the
password-less ssh to slave. This will create the secret pem pub file
which would have information of RSA key of all the nodes in the master
volume. And when geo-rep create command is executed, glusterd uses this
file to establish a geo-rep specific ssh connections</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gluster system:: execute gsec_create</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="creating-geo-replication-session."><a class="anchor" href="#creating-geo-replication-session."></a>Creating geo-replication session.</h5>
<div class="paragraph">
<p>Create a geo-rep session between master and slave volume using the
following command. The node in which this command is executed and the
specified in the command should have password less ssh setup between
them. The push-pem option actually uses the secret pem pub file created
earlier and establishes geo-rep specific password less ssh between each
node in master to each node of slave.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; create push-pem [force]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the total available size in slave volume is less than the total size
of master, the command will throw error message. In such cases 'force'
option can be used.</p>
</div>
<div class="paragraph">
<p>In use cases where the rsa-keys of nodes in master volume is distributed
to slave nodes through an external agent and slave side verifications
like: - if ssh port 22 is open in slave - has proper passwordless ssh
login setup - slave volume is created and is empty - if slave has enough
memory is taken care by the external agent, the following command can be
used to create geo-replication:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; create no-verify [force]</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case the master node rsa-key distribution to slave node does not
happen and above mentioned slave verification is not performed and these
two things has to be taken care externaly.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creating-non-root-geo-replication-session"><a class="anchor" href="#creating-non-root-geo-replication-session"></a>Creating Non Root Geo-replication session</h4>
<div class="paragraph">
<p><code>mountbroker</code> is a new service of glusterd. This service allows an
unprivileged process to own a GlusterFS mount by registering a label
(and DSL (Domain-specific language) options ) with glusterd through a
glusterd volfile. Using CLI, you can send a mount request to glusterd to
receive an alias (symlink) of the mounted volume.</p>
</div>
<div class="paragraph">
<p>A request from the agent, the unprivileged slave agents use the
mountbroker service of glusterd to set up an auxiliary gluster mount for
the agent in a special environment which ensures that the agent is only
allowed to access with special parameters that provide administrative
level access to the particular volume.</p>
</div>
<div class="paragraph">
<p><strong>To setup an auxiliary gluster mount for the agent</strong>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In all Slave nodes, Create a new group. For example, <code>geogroup</code></p>
</li>
<li>
<p>In all Slave nodes, Create a unprivileged account. For example,
<code>geoaccount</code>. Make it a member of <code>geogroup</code></p>
</li>
<li>
<p>In all Slave nodes, Create a new directory owned by root and with
permissions <em>0711.</em> For example, create mountbroker-root directory
<code>/var/mountbroker-root</code></p>
</li>
<li>
<p>In any one of Slave node, Run the following commands to add options
to glusterd vol file(<code>/etc/glusterfs/glusterd.vol</code> in rpm installations
and <code>/usr/local/etc/glusterfs/glusterd.vol</code> in Source installation.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gluster system:: execute mountbroker opt mountbroker-root /var/mountbroker-root
gluster system:: execute mountbroker opt geo-replication-log-group geogroup
gluster system:: execute mountbroker opt rpc-auth-allow-insecure on</code></pre>
</div>
</div>
</li>
<li>
<p>In any one of Slave node, Add Mountbroker user to glusterd vol file
using,</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gluster system:: execute mountbroker user geoaccount slavevol</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Where <code>slavevol</code> is Slave Volume name.</p>
</div>
<div class="paragraph">
<p>If you host multiple slave volumes on Slave, for each of them and add
the following options to the volfile using</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster system:: execute mountbroker user geoaccount2 slavevol2
gluster system:: execute mountbroker user geoaccount3 slavevol3
```</pre>
</div>
</div>
<div class="paragraph">
<p>To add multiple volumes per mountbroker user,</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster system:: execute mountbroker user geoaccount1 slavevol11,slavevol12,slavevol13
gluster system:: execute mountbroker user geoaccount2 slavevol21,slavevol22
gluster system:: execute mountbroker user geoaccount3 slavevol31
```</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Restart <code>glusterd</code> service on all the Slave nodes</p>
</li>
<li>
<p>Setup a passwdless SSH from one of the master node to the user on
one of the slave node. For example, to geoaccount.</p>
</li>
<li>
<p>Create a geo-replication relationship between master and slave to
the user by running the following command on the master node: For
example,</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; create push-pem [force]</code></pre>
</div>
</div>
</li>
<li>
<p>In the slavenode, which is used to create relationship, run
<code>/usr/libexec/glusterfs/set_geo_rep_pem_keys.sh</code> as a root with user
name, master volume name, and slave volume names as the arguments.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">/usr/libexec/glusterfs/set_geo_rep_pem_keys.sh &lt;mountbroker_user&gt; &lt;master_volume&gt; &lt;slave_volume&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>NOTE:</p>
</div>
<div class="paragraph">
<p>When mountbroker geo-rep session is deleted, following commands can be
used to remove volumes per mountbroker user. If the volume to be removed
is the last one for the mountbroker user, the user is also removed.</p>
</div>
<div class="paragraph">
<p>To delete a volumes per mountbroker user,</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster system:: execute mountbroker volumedel geoaccount2 slavevol2
```</pre>
</div>
</div>
<div class="paragraph">
<p>To delete multiple volumes per mountbroker user,</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster system:: execute mountbroker volumedel geoaccount2 slavevol1,slavevol2
```</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-meta-volume"><a class="anchor" href="#configuring-meta-volume"></a>Configuring meta volume</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If shared meta volume is already created and mounted at
'/var/run/gluster/shared_storage' as part of nfs or snapshot, please
jump into section 'Configure meta volume with geo-replication'.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A 3-way replicated common gluster meta-volume should be configured and
is shared by nfs, snapshot and geo-replication. The name of the
meta-volume should be 'gluster_shared_storage' and should be mounted at
'/var/run/gluster/shared_storage/'.</p>
</div>
<div class="paragraph">
<p>The meta volume needs to be configured with geo-replication to better
handle rename and other consistency issues in geo-replication during
brick/node down scenarios when master volume is configured with
EC(Erasure Code)/AFR.</p>
</div>
<div class="paragraph">
<p><strong>Following are the steps to configure meta volume:</strong></p>
</div>
<div class="paragraph">
<p>Create a 3 way replicated meta volume in the master cluster with all
three bricks from different nodes as follows.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    gluster volume create gluster_shared_storage replica 3 &lt;host1&gt;:&lt;brick_path&gt; &lt;host2&gt;:&lt;brick_path&gt; &lt;host3&gt;:&lt;brick_path&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Start the meta volume as follows.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    gluster volume start &lt;meta_vol&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Mount the meta volume as follows in all the master nodes.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    mount -t glusterfs &lt;master_host&gt;:gluster_shared_storage /var/run/gluster/shared_storage</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-meta-volume-with-geo-replication-session"><a class="anchor" href="#configure-meta-volume-with-geo-replication-session"></a>Configure meta volume with geo-replication session</h4>
<div class="literalblock">
<div class="content">
<pre>    gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config use_meta_volume true

If Mountbroker Setup,

    gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config use_meta_volume true</pre>
</div>
</div>
<div class="sect4">
<h5 id="starting-a-geo-rep-session"><a class="anchor" href="#starting-a-geo-rep-session"></a>Starting a geo-rep session</h5>
<div class="paragraph">
<p>There is no change in this command from previous versions to this
version.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; start
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; start
```</pre>
</div>
</div>
<div class="paragraph">
<p>This command actually starts the session. Meaning the gsyncd monitor
process will be started, which in turn spawns gsync worker processes
whenever required. This also turns on changelog xlator (if not in ON
state already), which starts recording all the changes on each of the
glusterfs bricks. And if master is empty during geo-rep start, the
change detection mechanism will be changelog. Else itâ€™ll be xsync (the
changes are identified by crawling through filesystem). Later when the
initial data is syned to slave, change detection mechanism will be set
to changelog</p>
</div>
</div>
<div class="sect4">
<h5 id="status-of-geo-replication"><a class="anchor" href="#status-of-geo-replication"></a>Status of geo-replication</h5>
<div class="paragraph">
<p>gluster now has variants of status command.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; status
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; status
```</pre>
</div>
</div>
<div class="paragraph">
<p>This displays the status of session from each brick of the master to
each brick of the slave node.</p>
</div>
<div class="paragraph">
<p>If you want more detailed status, then run 'status detail'</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; status detail
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; status detail
```</pre>
</div>
</div>
<div class="paragraph">
<p>This command displays extra information like, total files synced, files
that needs to be synced, deletes pending etc.</p>
</div>
</div>
<div class="sect4">
<h5 id="stopping-geo-replication-session"><a class="anchor" href="#stopping-geo-replication-session"></a>Stopping geo-replication session</h5>
<div class="paragraph">
<p>This command stops all geo-rep relates processes i.e. gsyncd monitor and
works processes. Note that changelog will <strong>not</strong> be turned off with this
command.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; stop [force]
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; stop [force]
```</pre>
</div>
</div>
<div class="paragraph">
<p>Force option is to be used, when one of the node (or glusterd in one of
the node) is down. Once stopped, the session can be restarted any time.
Note that upon restarting of the session, the change detection mechanism
falls back to xsync mode. This happens even though you have changelog
generating journals, while the geo-rep session is stopped.</p>
</div>
</div>
<div class="sect4">
<h5 id="deleting-geo-replication-session"><a class="anchor" href="#deleting-geo-replication-session"></a>Deleting geo-replication session</h5>
<div class="paragraph">
<p>Now you can delete the glusterfs geo-rep session. This will delete all
the config data associated with the geo-rep session.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; delete
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; delete
```</pre>
</div>
</div>
<div class="paragraph">
<p>This deletes all the gsync conf files in each of the nodes. This returns
failure, if any of the node is down. And unlike geo-rep stop, there is
'force' option with this.</p>
</div>
</div>
<div class="sect4">
<h5 id="changing-the-config-values"><a class="anchor" href="#changing-the-config-values"></a>Changing the config values</h5>
<div class="paragraph">
<p>There are some configuration values which can be changed using the CLI.
And you can see all the current config values with following command.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config
```</pre>
</div>
</div>
<div class="paragraph">
<p>But you can check only one of them, like log_file or change-detector</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config log-file
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config log-file

gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config change-detector
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config change-detector

gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config working-dir
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config working-dir
```</pre>
</div>
</div>
<div class="paragraph">
<p>To set a new value to this, just provide a new value. Note that, not all
the config values are allowed to change. Some can not be modified.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config change-detector xsync
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config change-detector xsync
```</pre>
</div>
</div>
<div class="paragraph">
<p>Make sure you provide the proper value to the config value. And if you
have large number of small files data set, then you can use tar+ssh as
syncing method. Note that, if geo-rep session is running, this restarts
the gsyncd.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config use-tarssh true
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config use-tarssh true
```</pre>
</div>
</div>
<div class="paragraph">
<p>Resetting these value to default is also simple.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```sh
gluster volume geo-replication &lt;master_volume&gt; &lt;slave_host&gt;::&lt;slave_volume&gt; config \!use-tarssh
# If Mountbroker Setup,
gluster volume geo-replication &lt;master_volume&gt; &lt;mountbroker_user&gt;@&lt;slave_host&gt;::&lt;slave_volume&gt; config \!use-tarssh
```</pre>
</div>
</div>
<div class="paragraph">
<p>That makes the config key (tar-ssh in this case) to fall back to it&#8217;s
default value.</p>
</div>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
   <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
   <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>