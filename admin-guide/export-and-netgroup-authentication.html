<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Gluster User Documentation Latest | Gluster Docs Project | Export and netgroup authentication</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <link href="../../latest/_stylesheets/asciibinder.css" rel="stylesheet" />

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="../../latest/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="../../latest/_images/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="http://www.asciibinder.org/"><img alt="AsciiBinder" src="../../latest/_images/asciibinder-logo-horizontal.png"></a>
      </div>
    </div>
  </div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../index.html">Home</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster User Documentation Latest</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster Docs Project</a>
      </li>
      
      <li class="hidden-xs active">
        Export and netgroup authentication
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Gluster Docs Project
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../admin-guide/index.html">Index</a></li>
            <li><a class="" href="../admin-guide/access-control-lists.html">Access Control Lists</a></li>
            <li><a class="" href="../admin-guide/accessing-gluster-from-windows.html">Accessing Gluster from Windows</a></li>
            <li><a class="" href="../admin-guide/arbiter-volumes-and-quorum.html">Arbiter-volumes and Quorum</a></li>
            <li><a class="" href="../admin-guide/bareos.html">BareOS</a></li>
            <li><a class="" href="../admin-guide/brick-naming-conventions.html">Brick naming conventions</a></li>
            <li><a class="" href="../admin-guide/building-qemu-with-gfapi-for-debian-based-systems.html">Building QEMU with gfapi for Debian-based systems</a></li>
            <li><a class="" href="../admin-guide/cinder.html">Cinder</a></li>
            <li><a class="" href="../admin-guide/Console.html">Console</a></li>
            <li><a class="" href="../admin-guide/compiling-rpms.html">Compiling RPMs</a></li>
            <li><a class="" href="../admin-guide/coreutils.html">Coreutils</a></li>
            <li><a class="" href="../admin-guide/did-you-know.html">Did you know</a></li>
            <li><a class="" href="../admin-guide/directory-quota.html">Diectory Quota</a></li>
            <li><a class="" href="../admin-guide/distributed-geo-replication.html">Distributed Geo Replication</a></li>
            <li><a class=" active" href="../admin-guide/export-and-netgroup-authentication.html">Export and netgroup authentication</a></li>
            <li><a class="" href="../admin-guide/filter.html">Filter</a></li>
            <li><a class="" href="../admin-guide/geo-replication.html">Geo Replication</a></li>
            <li><a class="" href="../admin-guide/glossary.html">Glossary</a></li>
            <li><a class="" href="../admin-guide/gluster-on-zfs.html">Gluster on ZFS</a></li>
            <li><a class="" href="../admin-guide/Hadoop.html">Hadoop</a></li>
            <li><a class="" href="../admin-guide/Handling-of-users-with-many-groups.html">Handling of users with many groups</a></li>
            <li><a class="" href="../admin-guide/introduction.html">Introduction</a></li>
            <li><a class="" href="../admin-guide/iscsi.html">iSCSI</a></li>
            <li><a class="" href="../admin-guide/keystore-quickstart.html">Keystore Quickstart</a></li>
            <li><a class="" href="../admin-guide/linux-kernel-tuning.html">Linux Kernel Tuning</a></li>
            <li><a class="" href="../admin-guide/logging.html">Logging</a></li>
            <li><a class="" href="../admin-guide/managing-snapshots.html">Managing snapshots</a></li>
            <li><a class="" href="../admin-guide/managing-volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../admin-guide/mandatory-locks.html">Mandatory Locks</a></li>
            <li><a class="" href="../admin-guide/monitoring-workload.html">Monitoring Workload</a></li>
            <li><a class="" href="../admin-guide/network-configuration-techniques.html">Network Configuration Techniques</a></li>
            <li><a class="" href="../admin-guide/nfs-ganesha-integration.html">NFS-Ganesha Integration</a></li>
            <li><a class="" href="../admin-guide/object-storage.html">Object storage</a></li>
            <li><a class="" href="../admin-guide/performance-testing.html">Performance Testing</a></li>
            <li><a class="" href="../admin-guide/Puppet.html">Puppet</a></li>
            <li><a class="" href="../admin-guide/rdma-transport.html">RDMA Transport</a></li>
            <li><a class="" href="../admin-guide/resolving-peer-rejected.html">Resolving Peer Rejected</a></li>
            <li><a class="" href="../admin-guide/setting-up-clients.html">Setting up Clients</a></li>
            <li><a class="" href="../admin-guide/setting-up-volumes.html">Setting up volumes</a></li>
            <li><a class="" href="../admin-guide/ssl.html">SSL</a></li>
            <li><a class="" href="../admin-guide/start-stop-daemon.html">Start Stop Daemon</a></li>
            <li><a class="" href="../admin-guide/storage-pools.html">Storage Pools</a></li>
            <li><a class="" href="../admin-guide/trash.html">Trash</a></li>
            <li><a class="" href="../admin-guide/troubleshooting.html">Troubleshooting</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Exports and Netgroups Authentication for NFS</h2>
        </div>
        <div class="sect2">
<h3 id="exports-and-netgroups-authentication-for-nfs"><a class="anchor" href="#exports-and-netgroups-authentication-for-nfs"></a>Exports and Netgroups Authentication for NFS</h3>
<div class="paragraph">
<p>This feature adds Linux-style exports &amp; netgroups authentication to
Gluster&#8217;s NFS server. More specifically, this feature allows users to
restrict access specific IPs (exports authentication) or a netgroup
(netgroups authentication), or a combination of both for both Gluster
volumes and subdirectories within Gluster volumes. Netgroups are used in
Unix environments to control access for NFS exports, remote logins and
remote shells. Each netgroup has a unique name and defines a set of
hosts, users, groups and other netgroups. This information is stored in
files and gluster NFS server manage permission for clients based on
those file</p>
</div>
</div>
<div class="sect2">
<h3 id="implications-and-usage"><a class="anchor" href="#implications-and-usage"></a>Implications and Usage</h3>
<div class="paragraph">
<p>Currently, gluster can restrict access to volumes through simple IP
list. But this feature makes that capability more scalable by allowing
large lists of IPs to be managed through a netgroup. Moreover it
provides more granular permission handling on volumes like wildcard
support, read-only permission to certain client etc.</p>
</div>
<div class="paragraph">
<p>The file <code>/var/lib/glusterd/nfs/export</code> contains the details of machines
which can be used as clients for that server.An typical export entry use
the following format :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    /&lt;export path&gt; &lt;host/netgroup&gt; (options),..</pre>
</div>
</div>
<div class="paragraph">
<p>Here export name can be gluster volume or subdirectory path inside that
volume. Next it contains list of host/netgroup , followed by the options
applicable to that entry.A string beginning with an '@' is treated as a
netgroup and a string beginning without an @ is a host. The options
include mount related parameters , right now options such as "sec",
"ro/rw", "anonuid" valid one. If * is mention as host/netgroup field ,
then any client can mount that export path.</p>
</div>
<div class="paragraph">
<p>The file <code>/var/lib/glusterd/nfs/netgroup</code> should mention the expansion
of each netgroup which mentioned in the export file. An typical netgroup
entry will look like :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    &lt;netgroup name&gt; ng1000\nng1000 ng999\nng999 ng1\nng1 ng2\nng2 (ip1, ip2,..)</pre>
</div>
</div>
<div class="paragraph">
<p>The gluster NFS server will check the contents of these file after
specific time intervals</p>
</div>
</div>
<div class="sect2">
<h3 id="volume-options"><a class="anchor" href="#volume-options"></a>Volume Options</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enabling export/netgroup feature</p>
<div class="literalblock">
<div class="content">
<pre>gluster volume set &lt;volname&gt; nfs.exports-auth-enable on</pre>
</div>
</div>
</li>
<li>
<p>Changing the refresh interval for gluster NFS server</p>
<div class="literalblock">
<div class="content">
<pre>gluster volume set &lt;volname&gt; nfs.auth-refresh-interval-sec &lt;time in seconds&gt;</pre>
</div>
</div>
</li>
<li>
<p>Changing the cache interval for an export entry</p>
<div class="literalblock">
<div class="content">
<pre>gluster volume set &lt;volname&gt; nfs.auth-cache-ttl-sec &lt;time in seconds&gt;</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="testing-the-exportnetgroup-file"><a class="anchor" href="#testing-the-exportnetgroup-file"></a>Testing the export/netgroup file</h3>
<div class="paragraph">
<p>An user should have the ability to check the validity of the files
before applying the configuration. The "glusterfsd" command now has the
following additional arguments that can be used to check the
configuration: - --print-netgroups: Validate the netgroups file and
print it out. For example, -
<code>glusterfsd --print-netgroups &lt;name of the file&gt;</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>--print-exports: Validate the exports file and print it out. For
example,</p>
<div class="ulist">
<ul>
<li>
<p><code>glusterfsd --print-export &lt;name of the file&gt;</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="points-to-be-noted."><a class="anchor" href="#points-to-be-noted."></a>Points to be noted.</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This feature does not currently support all the options in the man
page of exports, but we can easily add them.</p>
</li>
<li>
<p>The files <code>/var/lib/glusterd/nfs/export</code> and
<code>/var/lib/glusterd/nfs/netgroup</code> should be created before setting the
<code>nfs.exports-auth-enable</code> option in every node in Trusted Storage Pool.</p>
</li>
<li>
<p>These files are handled mannually by the users. So that, their
contents can be different among the gluster nfs servers across Trusted
Storage Pool . i.e it is possible to have different authenticate
mechanism for the gluster NFS servers in the same cluster.</p>
</li>
<li>
<p>Do not mixup this feature and authentication using
<code>nfs.rpc-auth-allow</code>, <code>nfs.export-dir</code> which may result in
inconsistency.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a>Troubleshooting</h3>
<div class="paragraph">
<p>After changing the contents of the file, if it is not reflected properly
in the authentication mechanism , just restart the server using volume
stop and start, So that gluster NFS server will forcefully read the
contents of those files again.</p>
</div>
</div>
      </div>
    </div>
  </div>
   <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
   <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>