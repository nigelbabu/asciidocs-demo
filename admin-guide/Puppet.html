<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Gluster User Documentation Latest | Gluster Docs Project | Puppet</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <link href="../../latest/_stylesheets/asciibinder.css" rel="stylesheet" />

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="../../latest/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="../../latest/_images/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="http://www.asciibinder.org/"><img alt="AsciiBinder" src="../../latest/_images/asciibinder-logo-horizontal.png"></a>
      </div>
    </div>
  </div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../index.html">Home</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster User Documentation Latest</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster Docs Project</a>
      </li>
      
      <li class="hidden-xs active">
        Puppet
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Gluster Docs Project
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../admin-guide/index.html">Index</a></li>
            <li><a class="" href="../admin-guide/access-control-lists.html">Access Control Lists</a></li>
            <li><a class="" href="../admin-guide/accessing-gluster-from-windows.html">Accessing Gluster from Windows</a></li>
            <li><a class="" href="../admin-guide/arbiter-volumes-and-quorum.html">Arbiter-volumes and Quorum</a></li>
            <li><a class="" href="../admin-guide/bareos.html">BareOS</a></li>
            <li><a class="" href="../admin-guide/brick-naming-conventions.html">Brick naming conventions</a></li>
            <li><a class="" href="../admin-guide/building-qemu-with-gfapi-for-debian-based-systems.html">Building QEMU with gfapi for Debian-based systems</a></li>
            <li><a class="" href="../admin-guide/cinder.html">Cinder</a></li>
            <li><a class="" href="../admin-guide/Console.html">Console</a></li>
            <li><a class="" href="../admin-guide/compiling-rpms.html">Compiling RPMs</a></li>
            <li><a class="" href="../admin-guide/coreutils.html">Coreutils</a></li>
            <li><a class="" href="../admin-guide/did-you-know.html">Did you know</a></li>
            <li><a class="" href="../admin-guide/directory-quota.html">Diectory Quota</a></li>
            <li><a class="" href="../admin-guide/distributed-geo-replication.html">Distributed Geo Replication</a></li>
            <li><a class="" href="../admin-guide/export-and-netgroup-authentication.html">Export and netgroup authentication</a></li>
            <li><a class="" href="../admin-guide/filter.html">Filter</a></li>
            <li><a class="" href="../admin-guide/geo-replication.html">Geo Replication</a></li>
            <li><a class="" href="../admin-guide/glossary.html">Glossary</a></li>
            <li><a class="" href="../admin-guide/gluster-on-zfs.html">Gluster on ZFS</a></li>
            <li><a class="" href="../admin-guide/Hadoop.html">Hadoop</a></li>
            <li><a class="" href="../admin-guide/Handling-of-users-with-many-groups.html">Handling of users with many groups</a></li>
            <li><a class="" href="../admin-guide/introduction.html">Introduction</a></li>
            <li><a class="" href="../admin-guide/iscsi.html">iSCSI</a></li>
            <li><a class="" href="../admin-guide/keystore-quickstart.html">Keystore Quickstart</a></li>
            <li><a class="" href="../admin-guide/linux-kernel-tuning.html">Linux Kernel Tuning</a></li>
            <li><a class="" href="../admin-guide/logging.html">Logging</a></li>
            <li><a class="" href="../admin-guide/managing-snapshots.html">Managing snapshots</a></li>
            <li><a class="" href="../admin-guide/managing-volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../admin-guide/mandatory-locks.html">Mandatory Locks</a></li>
            <li><a class="" href="../admin-guide/monitoring-workload.html">Monitoring Workload</a></li>
            <li><a class="" href="../admin-guide/network-configuration-techniques.html">Network Configuration Techniques</a></li>
            <li><a class="" href="../admin-guide/nfs-ganesha-integration.html">NFS-Ganesha Integration</a></li>
            <li><a class="" href="../admin-guide/object-storage.html">Object storage</a></li>
            <li><a class="" href="../admin-guide/performance-testing.html">Performance Testing</a></li>
            <li><a class=" active" href="../admin-guide/Puppet.html">Puppet</a></li>
            <li><a class="" href="../admin-guide/rdma-transport.html">RDMA Transport</a></li>
            <li><a class="" href="../admin-guide/resolving-peer-rejected.html">Resolving Peer Rejected</a></li>
            <li><a class="" href="../admin-guide/setting-up-clients.html">Setting up Clients</a></li>
            <li><a class="" href="../admin-guide/setting-up-volumes.html">Setting up volumes</a></li>
            <li><a class="" href="../admin-guide/ssl.html">SSL</a></li>
            <li><a class="" href="../admin-guide/start-stop-daemon.html">Start Stop Daemon</a></li>
            <li><a class="" href="../admin-guide/storage-pools.html">Storage Pools</a></li>
            <li><a class="" href="../admin-guide/trash.html">Trash</a></li>
            <li><a class="" href="../admin-guide/troubleshooting.html">Troubleshooting</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Puppet-Gluster</h2>
        </div>
        <div class="sect1">
<h2 id="puppet-gluster"><a class="anchor" href="#puppet-gluster"></a>Puppet-Gluster</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="a-glusterfs-puppet-module-by-james"><a class="anchor" href="#a-glusterfs-puppet-module-by-james"></a>A GlusterFS Puppet module by <a href="https://ttboj.wordpress.com/">James</a></h3>
<div class="sect4">
<h5 id="available-from"><a class="anchor" href="#available-from"></a>Available from:</h5>

</div>
<div class="sect4">
<h5 id="httpsgithub.compurpleideapuppet-gluster"><a class="anchor" href="#httpsgithub.compurpleideapuppet-gluster"></a><a href="https://github.com/purpleidea/puppet-gluster/" class="bare">https://github.com/purpleidea/puppet-gluster/</a></h5>

</div>
<div class="sect4">
<h5 id="also-available-from"><a class="anchor" href="#also-available-from"></a>Also available from:</h5>

</div>
<div class="sect4">
<h5 id="httpsforge.gluster.orgpuppet-gluster"><a class="anchor" href="#httpsforge.gluster.orgpuppet-gluster"></a><a href="https://forge.gluster.org/puppet-gluster/" class="bare">https://forge.gluster.org/puppet-gluster/</a></h5>

</div>
<div class="sect4">
<h5 id="table-of-contents"><a class="anchor" href="#table-of-contents"></a>Table of Contents</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#overview">Overview</a></p>
</li>
<li>
<p><a href="#module-description">Module description - What the module does</a></p>
</li>
<li>
<p><a href="#setup">Setup - Getting started with Puppet-Gluster</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#what-can-puppet-gluster-manage">What can Puppet-Gluster manage?</a></p>
</li>
<li>
<p><a href="#simple-setup">Simple setup</a></p>
</li>
<li>
<p><a href="#elastic-setup">Elastic setup</a></p>
</li>
<li>
<p><a href="#advanced-setup">Advanced setup</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#usage-and-frequently-asked-questions">Usage/FAQ - Notes on
management and frequently asked questions</a></p>
</li>
<li>
<p><a href="#reference">Reference - Class and type reference</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#glustersimple">gluster::simple</a></p>
</li>
<li>
<p><a href="#glusterelastic">gluster::elastic</a></p>
</li>
<li>
<p><a href="#glusterserver">gluster::server</a></p>
</li>
<li>
<p><a href="#glusterhost">gluster::host</a></p>
</li>
<li>
<p><a href="#glusterbrick">gluster::brick</a></p>
</li>
<li>
<p><a href="#glustervolume">gluster::volume</a></p>
</li>
<li>
<p><a href="#glustervolumeproperty">gluster::volume::property</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#examples">Examples - Example configurations</a></p>
</li>
<li>
<p><a href="#limitations">Limitations - Puppet versions, OS compatibility,
etc&#8230;&#8203;</a></p>
</li>
<li>
<p><a href="#development">Development - Background on module development</a></p>
</li>
<li>
<p><a href="#author">Author - Author and contact information</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="overview"><a class="anchor" href="#overview"></a>Overview</h3>
<div class="paragraph">
<p>The Puppet-Gluster module installs, configures, and manages a GlusterFS
cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="module-description"><a class="anchor" href="#module-description"></a>Module Description</h3>
<div class="paragraph">
<p>This Puppet-Gluster module handles installation, configuration, and
management of GlusterFS across all of the hosts in the cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="setup"><a class="anchor" href="#setup"></a>Setup</h3>
<div class="sect3">
<h4 id="what-can-puppet-gluster-manage"><a class="anchor" href="#what-can-puppet-gluster-manage"></a>What can Puppet-Gluster manage?</h4>
<div class="paragraph">
<p>Puppet-Gluster is designed to be able to manage as much or as little of
your GlusterFS cluster as you wish. All features are optional. If there
is a feature that doesn&#8217;t appear to be optional, and you believe it
should be, please let me know. Having said that, it makes good sense to
me to have Puppet-Gluster manage as much of your GlusterFS
infrastructure as it can. At the moment, it cannot rack new servers, but
I am accepting funding to explore this feature ;) At the moment it can
manage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GlusterFS packages (rpm)</p>
</li>
<li>
<p>GlusterFS configuration files (/var/lib/glusterd/)</p>
</li>
<li>
<p>GlusterFS host peering (gluster peer probe)</p>
</li>
<li>
<p>GlusterFS storage partitioning (fdisk)</p>
</li>
<li>
<p>GlusterFS storage formatting (mkfs)</p>
</li>
<li>
<p>GlusterFS brick creation (mkdir)</p>
</li>
<li>
<p>GlusterFS services (glusterd)</p>
</li>
<li>
<p>GlusterFS firewalling (whitelisting)</p>
</li>
<li>
<p>GlusterFS volume creation (gluster volume create)</p>
</li>
<li>
<p>GlusterFS volume state (started/stopped)</p>
</li>
<li>
<p>GlusterFS volume properties (gluster volume set)</p>
</li>
<li>
<p>And much more&#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="simple-setup"><a class="anchor" href="#simple-setup"></a>Simple setup</h4>
<div class="paragraph">
<p>include '::gluster::simple' is enough to get you up and running. When
using the gluster::simple class, or with any other Puppet-Gluster
configuration, identical definitions must be used on all hosts in the
cluster. The simplest way to accomplish this is with a single shared
puppet host definition like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="puppet">node /^annex\d+$/ {        # annex{1,2,..N}
        class { '::gluster::simple':
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to pass in different parameters, you can specify them in the
class before you provision your hosts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="puppet">class { '::gluster::simple':
    replica =&gt; 2,
    volume =&gt; ['volume1', 'volume2', 'volumeN'],
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="elastic-setup"><a class="anchor" href="#elastic-setup"></a>Elastic setup</h4>
<div class="paragraph">
<p>The gluster::elastic class is not yet available. Stay tuned!</p>
</div>
</div>
<div class="sect3">
<h4 id="advanced-setup"><a class="anchor" href="#advanced-setup"></a>Advanced setup</h4>
<div class="paragraph">
<p>Some system administrators may wish to manually itemize each of the
required components for the Puppet-Gluster deployment. This happens
automatically with the higher level modules, but may still be a
desirable feature, particularly for non-elastic storage pools where the
configuration isn&#8217;t expected to change very often (if ever).</p>
</div>
<div class="paragraph">
<p>To put together your cluster piece by piece, you must manually include
and define each class and type that you wish to use. If there are
certain aspects that you wish to manage yourself, you can omit them from
your configuration. See the <a href="#reference">reference</a> section below for
the specifics. Here is one possible example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="puppet">class { '::gluster::server':
    shorewall =&gt; true,
}

gluster::host { 'annex1.example.com':
    # use uuidgen to make these
    uuid =&gt; '1f660ca2-2c78-4aa0-8f4d-21608218c69c',
}

# note that this is using a folder on your existing file system...
# this can be useful for prototyping gluster using virtual machines
# if this isn't a separate partition, remember that your root fs will
# run out of space when your gluster volume does!
gluster::brick { 'annex1.example.com:/data/gluster-storage1':
    areyousure =&gt; true,
}

gluster::host { 'annex2.example.com':
    # NOTE: specifying a host uuid is now optional!
    # if you don't choose one, one will be assigned
    #uuid =&gt; '2fbe6e2f-f6bc-4c2d-a301-62fa90c459f8',
}

gluster::brick { 'annex2.example.com:/data/gluster-storage2':
    areyousure =&gt; true,
}

$brick_list = [
    'annex1.example.com:/data/gluster-storage1',
    'annex2.example.com:/data/gluster-storage2',
]

gluster::volume { 'examplevol':
    replica =&gt; 2,
    bricks =&gt; $brick_list,
    start =&gt; undef, # i'll start this myself
}

# namevar must be: &lt;VOLNAME&gt;#&lt;KEY&gt;
gluster::volume::property { 'examplevol#auth.reject':
    value =&gt; ['192.0.2.13', '198.51.100.42', '203.0.113.69'],
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="usage-and-frequently-asked-questions"><a class="anchor" href="#usage-and-frequently-asked-questions"></a>Usage and frequently asked questions</h3>
<div class="paragraph">
<p>All management should be done by manipulating the arguments on the
appropriate Puppet-Gluster classes and types. Since certain
manipulations are either not yet possible with Puppet-Gluster, or are
not supported by GlusterFS, attempting to manipulate the Puppet
configuration in an unsupported way will result in undefined behaviour,
and possible even data loss, however this is unlikely.</p>
</div>
<div class="sect3">
<h4 id="how-do-i-change-the-replica-count"><a class="anchor" href="#how-do-i-change-the-replica-count"></a>How do I change the replica count?</h4>
<div class="paragraph">
<p>You must set this before volume creation. This is a limitation of
GlusterFS. There are certain situations where you can change the replica
count by adding a multiple of the existing brick count to get this
desired effect. These cases are not yet supported by Puppet-Gluster. If
you want to use Puppet-Gluster before and / or after this transition,
you can do so, but you&#8217;ll have to do the changes manually.</p>
</div>
</div>
<div class="sect3">
<h4 id="do-i-need-to-use-a-virtual-ip"><a class="anchor" href="#do-i-need-to-use-a-virtual-ip"></a>Do I need to use a virtual IP?</h4>
<div class="paragraph">
<p>Using a virtual IP (VIP) is strongly recommended as a distributed lock
manager (DLM) and also to provide a highly-available (HA) IP address for
your clients to connect to. For a more detailed explanation of the
reasoning please see:</p>
</div>
<div class="paragraph">
<p><a href="https://ttboj.wordpress.com/2012/08/23/how-to-avoid-cluster-race-conditions-or-how-to-implement-a-distributed-lock-manager-in-puppet/" class="bare">https://ttboj.wordpress.com/2012/08/23/how-to-avoid-cluster-race-conditions-or-how-to-implement-a-distributed-lock-manager-in-puppet/</a></p>
</div>
<div class="paragraph">
<p>Remember that even if you&#8217;re using a hosted solution (such as AWS) that
doesn&#8217;t provide an additional IP address, or you want to avoid using an
additional IP, and you&#8217;re okay not having full HA client mounting, you
can use an unused private RFC1918 IP address as the DLM VIP. Remember
that a layer 3 IP can co-exist on the same layer 2 network with the
layer 3 network that is used by your cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="is-it-possible-to-have-puppet-gluster-complete-in-a-single-run"><a class="anchor" href="#is-it-possible-to-have-puppet-gluster-complete-in-a-single-run"></a>Is it possible to have Puppet-Gluster complete in a single run?</h4>
<div class="paragraph">
<p>No. This is a limitation of Puppet, and is related to how GlusterFS
operates. For example, it is not reliably possible to predict which
ports a particular GlusterFS volume will run on until after the volume
is started. As a result, this module will initially whitelist
connections from GlusterFS host IP addresses, and then further restrict
this to only allow individual ports once this information is known. This
is possible in conjunction with the
<a href="https://github.com/purpleidea/puppet-shorewall">puppet-shorewall</a> module.
You should notice that each run should complete without error. If you do
see an error, it means that either something is wrong with your system
and / or configuration, or because there is a bug in Puppet-Gluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="can-you-integrate-this-with-vagrant"><a class="anchor" href="#can-you-integrate-this-with-vagrant"></a>Can you integrate this with vagrant?</h4>
<div class="paragraph">
<p>Not until vagrant properly supports libvirt/KVM. I have no desire to use
VirtualBox for fun.</p>
</div>
</div>
<div class="sect3">
<h4 id="awesome-work-but-its-missing-support-for-a-feature-andor-platform"><a class="anchor" href="#awesome-work-but-its-missing-support-for-a-feature-andor-platform"></a>Awesome work, but it&#8217;s missing support for a feature and/or platform!</h4>
<div class="paragraph">
<p>Since this is an Open Source / Free Software project that I also give
away for free (as in beer, free as in gratis, free as in libre), I&#8217;m
unable to provide unlimited support. Please consider donating funds,
hardware, virtual machines, and other resources. For specific needs, you
could perhaps sponsor a feature!</p>
</div>
</div>
<div class="sect3">
<h4 id="you-didnt-answer-my-question-or-i-have-a-question"><a class="anchor" href="#you-didnt-answer-my-question-or-i-have-a-question"></a>You didn&#8217;t answer my question, or I have a question!</h4>
<div class="paragraph">
<p>Contact me through my <a href="https://ttboj.wordpress.com/contact/">technical
blog</a> and I&#8217;ll do my best to help. If you have a good question, please
remind me to add my answer to this documentation!</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reference"><a class="anchor" href="#reference"></a>Reference</h3>
<div class="paragraph">
<p>Please note that there are a number of undocumented options. For more
information on these options, please view the source at:
<a href="https://github.com/purpleidea/puppet-gluster/" class="bare">https://github.com/purpleidea/puppet-gluster/</a>. If you feel that a well
used option needs documenting here, please contact me.</p>
</div>
<div class="sect3">
<h4 id="overview-of-classes-and-types"><a class="anchor" href="#overview-of-classes-and-types"></a>Overview of classes and types</h4>
<div class="ulist">
<ul>
<li>
<p><a href="#glustersimple">gluster::simple</a>: Simple Puppet-Gluster
deployment.</p>
</li>
<li>
<p><a href="#glusterelastic">gluster::elastic</a>: Under construction.</p>
</li>
<li>
<p><a href="#glusterserver">gluster::server</a>: Base class for server hosts.</p>
</li>
<li>
<p><a href="#glusterhost">gluster::host</a>: Host type for each participating
host.</p>
</li>
<li>
<p><a href="#glusterbrick">gluster::brick</a>: Brick type for each defined brick,
per host.</p>
</li>
<li>
<p><a href="#glustervolume">gluster::volume</a>: Volume type for each defined
volume.</p>
</li>
<li>
<p><a href="#glustervolumeproperty">gluster::volume::property</a>: Manages
properties for each volume.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="glustersimple"><a class="anchor" href="#glustersimple"></a>gluster::simple</h4>
<div class="paragraph">
<p>This is gluster::simple. It should probably take care of 80% of all use
cases. It is particularly useful for deploying quick test clusters. It
uses a finite-state machine (FSM) to decide when the cluster has settled
and volume creation can begin. For more information on the FSM in
Puppet-Gluster see:
<a href="https://ttboj.wordpress.com/2013/09/28/finite-state-machines-in-puppet/" class="bare">https://ttboj.wordpress.com/2013/09/28/finite-state-machines-in-puppet/</a></p>
</div>
<div class="sect4">
<h5 id="replica"><a class="anchor" href="#replica"></a><code>replica</code></h5>
<div class="paragraph">
<p>The replica count. Can&#8217;t be changed automatically after initial
deployment.</p>
</div>
</div>
<div class="sect4">
<h5 id="volume"><a class="anchor" href="#volume"></a><code>volume</code></h5>
<div class="paragraph">
<p>The volume name or list of volume names to create.</p>
</div>
</div>
<div class="sect4">
<h5 id="path"><a class="anchor" href="#path"></a><code>path</code></h5>
<div class="paragraph">
<p>The valid brick path for each host. Defaults to local file system. If
you need a different path per host, then Gluster::Simple will not meet
your needs.</p>
</div>
</div>
<div class="sect4">
<h5 id="vip"><a class="anchor" href="#vip"></a><code>vip</code></h5>
<div class="paragraph">
<p>The virtual IP address to be used for the cluster distributed lock
manager.</p>
</div>
</div>
<div class="sect4">
<h5 id="shorewall"><a class="anchor" href="#shorewall"></a><code>shorewall</code></h5>
<div class="paragraph">
<p>Boolean to specify whether puppet-shorewall integration should be used
or not.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="glusterelastic"><a class="anchor" href="#glusterelastic"></a>gluster::elastic</h4>
<div class="paragraph">
<p>Under construction.</p>
</div>
</div>
<div class="sect3">
<h4 id="glusterserver"><a class="anchor" href="#glusterserver"></a>gluster::server</h4>
<div class="paragraph">
<p>Main server class for the cluster. Must be included when building the
GlusterFS cluster manually. Wrapper classes such as
<a href="#glustersimple">gluster::simple</a> include this automatically.</p>
</div>
<div class="sect4">
<h5 id="vip-1"><a class="anchor" href="#vip-1"></a><code>vip</code></h5>
<div class="paragraph">
<p>The virtual IP address to be used for the cluster distributed lock
manager.</p>
</div>
</div>
<div class="sect4">
<h5 id="shorewall-1"><a class="anchor" href="#shorewall-1"></a><code>shorewall</code></h5>
<div class="paragraph">
<p>Boolean to specify whether puppet-shorewall integration should be used
or not.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="glusterhost"><a class="anchor" href="#glusterhost"></a>gluster::host</h4>
<div class="paragraph">
<p>Main host type for the cluster. Each host participating in the GlusterFS
cluster must define this type on itself, and on every other host. As a
result, this is not a singleton like the
<a href="#glusterserver">gluster::server</a> class.</p>
</div>
<div class="sect4">
<h5 id="ip"><a class="anchor" href="#ip"></a><code>ip</code></h5>
<div class="paragraph">
<p>Specify which IP address this host is using. This defaults to the
<em>$::ipaddress</em> variable. Be sure to set this manually if you&#8217;re
declaring this yourself on each host without using exported resources.
If each host thinks the other hosts should have the same IP address as
itself, then Puppet-Gluster and GlusterFS won&#8217;t work correctly.</p>
</div>
</div>
<div class="sect4">
<h5 id="uuid"><a class="anchor" href="#uuid"></a><code>uuid</code></h5>
<div class="paragraph">
<p>Universally unique identifier (UUID) for the host. If empty,
Puppet-Gluster will generate this automatically for the host. You can
generate your own manually with <em>uuidgen</em>, and set them yourself. I
found this particularly useful for testing, because I would pick easy to
recognize UUID&#8217;s like: <em>aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa</em>,
<em>bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb</em>, and so on. If you set a UUID
manually, and Puppet-Gluster has a chance to run, then it will remember
your choice, and store it locally to be used again if you no longer
specify the UUID. This is particularly useful for upgrading an existing
un-managed GlusterFS installation to a Puppet-Gluster managed one,
without changing any UUID&#8217;s.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="glusterbrick"><a class="anchor" href="#glusterbrick"></a>gluster::brick</h4>
<div class="paragraph">
<p>Main brick type for the cluster. Each brick is an individual storage
segment to be used on a host. Each host must have at least one brick to
participate in the cluster, but usually a host will have multiple
bricks. A brick can be as simple as a file system folder, or it can be a
separate file system. Please read the official GlusterFS documentation,
if you aren&#8217;t entirely comfortable with the concept of a brick.</p>
</div>
<div class="paragraph">
<p>For most test clusters, and for experimentation, it is easiest to use a
directory on the root file system. You can even use a <em>/tmp</em> sub folder
if you don&#8217;t care about the persistence of your data. For more serious
clusters, you might want to create separate file systems for your data.
On self-hosted iron, it is not uncommon to create multiple RAID-6 drive
pools, and to then create a separate file system per virtual drive. Each
file system can then be used as a single brick.</p>
</div>
<div class="paragraph">
<p>So that each volume in GlusterFS has the maximum ability to grow,
without having to partition storage separately, the bricks in
Puppet-Gluster are actually folders (on whatever backing store you wish)
which then contain sub folders-- one for each volume. As a result, all
the volumes on a given GlusterFS cluster can share the total available
storage space. If you wish to limit the storage used by each volume, you
can setup quotas. Alternatively, you can buy more hardware, and
elastically grow your GlusterFS volumes, since the price per GB will be
significantly less than any proprietary storage system. The one downside
to this brick sharing, is that if you have chosen the brick per host
count specifically to match your performance requirements, and each
GlusterFS volume on the same cluster has drastically different brick per
host performance requirements, then this won&#8217;t suit your needs. I doubt
that anyone actually has such requirements, but if you do insist on
needing this compartmentalization, then you can probably use the
Puppet-Gluster grouping feature to accomplish this goal. Please let me
know about your use-case, and be warned that the grouping feature hasn&#8217;t
been extensively tested.</p>
</div>
<div class="paragraph">
<p>To prove to you that I care about automation, this type offers the
ability to automatically partition and format your file systems. This
means you can plug in new iron, boot, provision and configure the entire
system automatically. Regrettably, I don&#8217;t have a lot of test hardware
to routinely use this feature. If you&#8217;d like to donate some, I&#8217;d be
happy to test this thoroughly. Having said that, I have used this
feature, I consider it to be extremely safe, and it has never caused me
to lose data. If you&#8217;re uncertain, feel free to look at the code, or
avoid using this feature entirely. If you think there&#8217;s a way to make it
even safer, then feel free to let me know.</p>
</div>
<div class="sect4">
<h5 id="dev"><a class="anchor" href="#dev"></a><code>dev</code></h5>
<div class="paragraph">
<p>Block device, such as <em>/dev/sdc</em> or
<em>/dev/disk/by-id/scsi-0123456789abcdef</em>. By default, Puppet-Gluster
will assume you&#8217;re using a folder to store the brick data, if you don&#8217;t
specify this parameter.</p>
</div>
</div>
<div class="sect4">
<h5 id="fsuuid"><a class="anchor" href="#fsuuid"></a><code>fsuuid</code></h5>
<div class="paragraph">
<p>File system UUID. This ensures we can distinctly identify a file system.
You can set this to be used with automatic file system creation, or you
can specify the file system UUID that you&#8217;d like to use.</p>
</div>
</div>
<div class="sect4">
<h5 id="labeltype"><a class="anchor" href="#labeltype"></a><code>labeltype</code></h5>
<div class="paragraph">
<p>Only <em>gpt</em> is supported. Other options include <em>msdos</em>, but this has
never been used because of it&#8217;s size limitations.</p>
</div>
</div>
<div class="sect4">
<h5 id="fstype"><a class="anchor" href="#fstype"></a><code>fstype</code></h5>
<div class="paragraph">
<p>This should be <em>xfs</em> or <em>ext4</em>. Using <em>xfs</em> is recommended, but <em>ext4</em>
is also quite common. This only affects a file system that is getting
created by this module. If you provision a new machine, with a root file
system of <em>ext4</em>, and the brick you create is a root file system path,
then this option does nothing.</p>
</div>
</div>
<div class="sect4">
<h5 id="xfs_inode64"><a class="anchor" href="#xfs_inode64"></a><code>xfs_inode64</code></h5>
<div class="paragraph">
<p>Set <em>inode64</em> mount option when using the <em>xfs</em> fstype. Choose <em>true</em> to
set.</p>
</div>
</div>
<div class="sect4">
<h5 id="xfs_nobarrier"><a class="anchor" href="#xfs_nobarrier"></a><code>xfs_nobarrier</code></h5>
<div class="paragraph">
<p>Set <em>nobarrier</em> mount option when using the <em>xfs</em> fstype. Choose <em>true</em>
to set.</p>
</div>
</div>
<div class="sect4">
<h5 id="ro"><a class="anchor" href="#ro"></a><code>ro</code></h5>
<div class="paragraph">
<p>Whether the file system should be mounted read only. For emergencies
only.</p>
</div>
</div>
<div class="sect4">
<h5 id="force"><a class="anchor" href="#force"></a><code>force</code></h5>
<div class="paragraph">
<p>If <em>true</em>, this will overwrite any xfs file system it sees. This is
useful for rebuilding GlusterFS repeatedly and wiping data. There are
other safeties in place to stop this. In general, you probably don&#8217;t
ever want to touch this.</p>
</div>
</div>
<div class="sect4">
<h5 id="areyousure"><a class="anchor" href="#areyousure"></a><code>areyousure</code></h5>
<div class="paragraph">
<p>Do you want to allow Puppet-Gluster to do dangerous things? You have to
set this to <em>true</em> to allow Puppet-Gluster to <em>fdisk</em> and <em>mkfs</em> your
file system.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="glustervolume"><a class="anchor" href="#glustervolume"></a>gluster::volume</h4>
<div class="paragraph">
<p>Main volume type for the cluster. This is where a lot of the magic
happens. Remember that changing some of these parameters after the
volume has been created won&#8217;t work, and you&#8217;ll experience undefined
behaviour. There could be FSM based error checking to verify that no
changes occur, but it has been left out so that this code base can
eventually support such changes, and so that the user can manually
change a parameter if they know that it is safe to do so.</p>
</div>
<div class="sect4">
<h5 id="bricks"><a class="anchor" href="#bricks"></a><code>bricks</code></h5>
<div class="paragraph">
<p>List of bricks to use for this volume. If this is left at the default
value of <em>true</em>, then this list is built automatically. The algorithm
that determines this order does not support all possible situations, and
most likely can&#8217;t handle certain corner cases. It is possible to examine
the FSM to view the selected brick order before it has a chance to
create the volume. The volume creation script won&#8217;t run until there is a
stable brick list as seen by the FSM running on the host that has the
DLM. If you specify this list of bricks manually, you must choose the
order to match your desired volume layout. If you aren&#8217;t sure about how
to order the bricks, you should review the GlusterFS documentation
first.</p>
</div>
</div>
<div class="sect4">
<h5 id="transport"><a class="anchor" href="#transport"></a><code>transport</code></h5>
<div class="paragraph">
<p>Only <em>tcp</em> is supported. Possible values can include <em>rdma</em>, but this
won&#8217;t get any testing if I don&#8217;t have access to infiniband hardware.
Donations welcome.</p>
</div>
</div>
<div class="sect4">
<h5 id="replica-1"><a class="anchor" href="#replica-1"></a><code>replica</code></h5>
<div class="paragraph">
<p>Replica count. Usually you&#8217;ll want to set this to <em>2</em>. Some users
choose <em>3</em>. Other values are seldom seen. A value of <em>1</em> can be used
for simply testing a distributed setup, when you don&#8217;t care about your
data or high availability. A value greater than <em>4</em> is probably wasteful
and unnecessary. It might even cause performance issues if a synchronous
write is waiting on a slow fourth server.</p>
</div>
</div>
<div class="sect4">
<h5 id="stripe"><a class="anchor" href="#stripe"></a><code>stripe</code></h5>
<div class="paragraph">
<p>Stripe count. Thoroughly unsupported and untested option. Not
recommended for use by GlusterFS.</p>
</div>
</div>
<div class="sect4">
<h5 id="ping"><a class="anchor" href="#ping"></a><code>ping</code></h5>
<div class="paragraph">
<p>Do we want to include ping checks with <em>fping</em>?</p>
</div>
</div>
<div class="sect4">
<h5 id="settle"><a class="anchor" href="#settle"></a><code>settle</code></h5>
<div class="paragraph">
<p>Do we want to run settle checks?</p>
</div>
</div>
<div class="sect4">
<h5 id="start"><a class="anchor" href="#start"></a><code>start</code></h5>
<div class="paragraph">
<p>Requested state for the volume. Valid values include: <em>true</em> (start),
<em>false</em> (stop), or <em>undef</em> (un-managed start/stop state).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="glustervolumeproperty"><a class="anchor" href="#glustervolumeproperty"></a>gluster::volume::property</h4>
<div class="paragraph">
<p>Main volume property type for the cluster. This allows you to manage
GlusterFS volume specific properties. There are a wide range of
properties that volumes support. For the full list of properties, you
should consult the GlusterFS documentation, or run the <em>gluster volume
set help</em> command. To set a property you must use the special name
pattern of: <em>volume</em>#<em>key</em>. The value argument is used to set the
associated value. It is smart enough to accept values in the most
logical format for that specific property. Some properties aren&#8217;t yet
supported, so please report any problems you have with this
functionality. Because this feature is an awesome way to <em>document as
code</em> the volume specific optimizations that you&#8217;ve made, make sure you
use this feature even if you don&#8217;t use all the others.</p>
</div>
<div class="sect4">
<h5 id="value"><a class="anchor" href="#value"></a><code>value</code></h5>
<div class="paragraph">
<p>The value to be used for this volume property.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples"><a class="anchor" href="#examples"></a>Examples</h3>
<div class="paragraph">
<p>For example configurations, please consult the
<a href="https://github.com/purpleidea/puppet-gluster/tree/master/examples">examples/</a>
directory in the git source repository. It is available from:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/purpleidea/puppet-gluster/tree/master/examples" class="bare">https://github.com/purpleidea/puppet-gluster/tree/master/examples</a></p>
</div>
<div class="paragraph">
<p>It is also available from:</p>
</div>
<div class="paragraph">
<p><a href="https://forge.gluster.org/puppet-gluster/puppet-gluster/trees/master/examples/">https://forge.gluster.org/puppet-gluster/puppet-gluster/trees/master/examples</a></p>
</div>
</div>
<div class="sect2">
<h3 id="limitations"><a class="anchor" href="#limitations"></a>Limitations</h3>
<div class="paragraph">
<p>This module has been tested against open source Puppet 3.2.4 and higher.</p>
</div>
<div class="paragraph">
<p>The module has been tested on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CentOS 6.4</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It will probably work without incident or without major modification on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CentOS 5.x/6.x</p>
</li>
<li>
<p>RHEL 5.x/6.x</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It will most likely work with other Puppet versions and on other
platforms, but testing under other conditions has been light due to lack
of resources. It will most likely not work on Debian/Ubuntu systems
without modification. I would really love to add support for these
operating systems, but I do not have any test resources to do so. Please
sponsor this if you&#8217;d like to see it happen.</p>
</div>
</div>
<div class="sect2">
<h3 id="development"><a class="anchor" href="#development"></a>Development</h3>
<div class="paragraph">
<p>This is my personal project that I work on in my free time. Donations of
funding, hardware, virtual machines, and other resources are
appreciated. Please contact me if you&#8217;d like to sponsor a feature,
invite me to talk/teach or for consulting.</p>
</div>
<div class="paragraph">
<p>You can follow along <a href="https://ttboj.wordpress.com/">on my technical blog</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="author"><a class="anchor" href="#author"></a>Author</h3>
<div class="paragraph">
<p>Copyright &#169; 2010-2013+ James Shubin</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/purpleidea/">github</a></p>
</li>
<li>
<p>[@purpleidea](<a href="https://twitter.com/#!/purpleidea" class="bare">https://twitter.com/#!/purpleidea</a>)</p>
</li>
<li>
<p><a href="https://ttboj.wordpress.com/" class="bare">https://ttboj.wordpress.com/</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
   <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
   <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>