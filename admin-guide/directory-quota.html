<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Gluster User Documentation Latest | Gluster Docs Project | Diectory Quota</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

    <link href="../../latest/_stylesheets/asciibinder.css" rel="stylesheet" />

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
   <!--[if lt IE 9]>
     <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
     <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
   <![endif]-->

  <link href="../../latest/_images/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="../../latest/_images/favicon.ico"><![endif]-->
  <meta content="AsciiBinder" name="application-name">
</head>
<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="http://www.asciibinder.org/"><img alt="AsciiBinder" src="../../latest/_images/asciibinder-logo-horizontal.png"></a>
      </div>
    </div>
  </div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../index.html">Home</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster User Documentation Latest</a>
      </li>
      <li class="hidden-xs active">
        <a href="../admin-guide/index.html">Gluster Docs Project</a>
      </li>
      
      <li class="hidden-xs active">
        Diectory Quota
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="#" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Gluster Docs Project
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li><a class="" href="../admin-guide/index.html">Index</a></li>
            <li><a class="" href="../admin-guide/access-control-lists.html">Access Control Lists</a></li>
            <li><a class="" href="../admin-guide/accessing-gluster-from-windows.html">Accessing Gluster from Windows</a></li>
            <li><a class="" href="../admin-guide/arbiter-volumes-and-quorum.html">Arbiter-volumes and Quorum</a></li>
            <li><a class="" href="../admin-guide/bareos.html">BareOS</a></li>
            <li><a class="" href="../admin-guide/brick-naming-conventions.html">Brick naming conventions</a></li>
            <li><a class="" href="../admin-guide/building-qemu-with-gfapi-for-debian-based-systems.html">Building QEMU with gfapi for Debian-based systems</a></li>
            <li><a class="" href="../admin-guide/cinder.html">Cinder</a></li>
            <li><a class="" href="../admin-guide/Console.html">Console</a></li>
            <li><a class="" href="../admin-guide/compiling-rpms.html">Compiling RPMs</a></li>
            <li><a class="" href="../admin-guide/coreutils.html">Coreutils</a></li>
            <li><a class="" href="../admin-guide/did-you-know.html">Did you know</a></li>
            <li><a class=" active" href="../admin-guide/directory-quota.html">Diectory Quota</a></li>
            <li><a class="" href="../admin-guide/distributed-geo-replication.html">Distributed Geo Replication</a></li>
            <li><a class="" href="../admin-guide/export-and-netgroup-authentication.html">Export and netgroup authentication</a></li>
            <li><a class="" href="../admin-guide/filter.html">Filter</a></li>
            <li><a class="" href="../admin-guide/geo-replication.html">Geo Replication</a></li>
            <li><a class="" href="../admin-guide/glossary.html">Glossary</a></li>
            <li><a class="" href="../admin-guide/gluster-on-zfs.html">Gluster on ZFS</a></li>
            <li><a class="" href="../admin-guide/Hadoop.html">Hadoop</a></li>
            <li><a class="" href="../admin-guide/Handling-of-users-with-many-groups.html">Handling of users with many groups</a></li>
            <li><a class="" href="../admin-guide/introduction.html">Introduction</a></li>
            <li><a class="" href="../admin-guide/iscsi.html">iSCSI</a></li>
            <li><a class="" href="../admin-guide/keystore-quickstart.html">Keystore Quickstart</a></li>
            <li><a class="" href="../admin-guide/linux-kernel-tuning.html">Linux Kernel Tuning</a></li>
            <li><a class="" href="../admin-guide/logging.html">Logging</a></li>
            <li><a class="" href="../admin-guide/managing-snapshots.html">Managing snapshots</a></li>
            <li><a class="" href="../admin-guide/managing-volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../admin-guide/mandatory-locks.html">Mandatory Locks</a></li>
            <li><a class="" href="../admin-guide/monitoring-workload.html">Monitoring Workload</a></li>
            <li><a class="" href="../admin-guide/network-configuration-techniques.html">Network Configuration Techniques</a></li>
            <li><a class="" href="../admin-guide/nfs-ganesha-integration.html">NFS-Ganesha Integration</a></li>
            <li><a class="" href="../admin-guide/object-storage.html">Object storage</a></li>
            <li><a class="" href="../admin-guide/performance-testing.html">Performance Testing</a></li>
            <li><a class="" href="../admin-guide/Puppet.html">Puppet</a></li>
            <li><a class="" href="../admin-guide/rdma-transport.html">RDMA Transport</a></li>
            <li><a class="" href="../admin-guide/resolving-peer-rejected.html">Resolving Peer Rejected</a></li>
            <li><a class="" href="../admin-guide/setting-up-clients.html">Setting up Clients</a></li>
            <li><a class="" href="../admin-guide/setting-up-volumes.html">Setting up volumes</a></li>
            <li><a class="" href="../admin-guide/ssl.html">SSL</a></li>
            <li><a class="" href="../admin-guide/start-stop-daemon.html">Start Stop Daemon</a></li>
            <li><a class="" href="../admin-guide/storage-pools.html">Storage Pools</a></li>
            <li><a class="" href="../admin-guide/trash.html">Trash</a></li>
            <li><a class="" href="../admin-guide/troubleshooting.html">Troubleshooting</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Managing Directory Quota</h2>
        </div>
        <div class="sect1">
<h2 id="managing-directory-quota"><a class="anchor" href="#managing-directory-quota"></a>Managing Directory Quota</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Directory quotas in GlusterFS allows you to set limits on usage of the
disk space by directories or volumes. The storage administrators can
control the disk space utilization at the directory and/or volume levels
in GlusterFS by setting limits to allocatable disk space at any level in
the volume and directory hierarchy. This is particularly useful in cloud
deployments to facilitate utility billing model.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> For now, only Hard limits are supported. Here, the limit cannot
be exceeded and attempts to use more disk space or inodes beyond the set
limit is denied.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>System administrators can also monitor the resource utilization to limit
the storage for the users depending on their role in the organization.</p>
</div>
<div class="paragraph">
<p>You can set the quota at the following levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Directory level</strong> – limits the usage at the directory level</p>
</li>
<li>
<p><strong>Volume level</strong> – limits the usage at the volume level</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> You can set the disk limit on the directory even if it is not
created. The disk limit is enforced immediately after creating that
directory.</p>
</div>
</blockquote>
</div>
<div class="sect2">
<h3 id="enabling-quota"><a class="anchor" href="#enabling-quota"></a>Enabling Quota</h3>
<div class="paragraph">
<p>You must enable Quota to set disk limits.</p>
</div>
<div class="paragraph">
<p><strong>To enable quota:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the following command to enable quota:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota  enable</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to enable quota on the test-volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume enable
Quota is enabled on /test-volume</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="disabling-quota"><a class="anchor" href="#disabling-quota"></a>Disabling Quota</h3>
<div class="paragraph">
<p>You can disable Quota, if needed.</p>
</div>
<div class="paragraph">
<p><strong>To disable quota:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the following command to disable quota:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota  disable</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to disable quota translator on the test-volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume disable
Quota translator is disabled on /test-volume</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="setting-or-replacing-disk-limit"><a class="anchor" href="#setting-or-replacing-disk-limit"></a>Setting or Replacing Disk Limit</h3>
<div class="paragraph">
<p>You can create new directories in your storage environment and set the
disk limit or set disk limit for the existing directories. The directory
name should be relative to the volume with the export directory/mount
being treated as "/".</p>
</div>
<div class="paragraph">
<p><strong>To set or replace disk limit:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the disk limit using the following command:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota  limit-usage /</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to set limit on data directory on the test-volume where
data is a directory under the export directory:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume limit-usage /data 10GB
Usage limit has been set on /data</pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> In a multi-level directory hierarchy, the strictest disk limit
will be considered for enforcement.</p>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="displaying-disk-limit-information"><a class="anchor" href="#displaying-disk-limit-information"></a>Displaying Disk Limit Information</h3>
<div class="paragraph">
<p>You can display disk limit information on all the directories on which
the limit is set.</p>
</div>
<div class="paragraph">
<p><strong>To display disk limit information:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Display disk limit information of all the directories on which limit
is set, using the following command:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota  list</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to see the set disks limit on the test-volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume list
/Test/data    10 GB       6 GB
/Test/data1   10 GB       4 GB</pre>
</div>
</div>
</li>
<li>
<p>Display disk limit information on a particular directory on which
limit is set, using the following command:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota  list</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to view the set limit on /data directory of test-volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume list /data
/Test/data    10 GB       6 GB</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="displaying-quota-limit-information-using-the-df-utility"><a class="anchor" href="#displaying-quota-limit-information-using-the-df-utility"></a>Displaying Quota Limit Information Using the df Utility</h4>
<div class="paragraph">
<p>You can create a report of the disk usage using the df utility by taking
quota limits into consideration. To generate a report, run the following
command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    # gluster volume set VOLNAME quota-deem-statfs on</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the total disk space of the directory is taken as the
quota hard limit set on the directory of the volume.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong> The default value for quota-deem-statfs is off. However, it is
recommended to set quota-deem-statfs to on.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The following example displays the disk usage when quota-deem-statfs is
off:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    # gluster volume set test-volume features.quota-deem-statfs off
    volume set: success
    # gluster volume quota test-volume list
    Path        Hard-limit    Soft-limit     Used     Available
    -----------------------------------------------------------
    /              300.0GB        90%        11.5GB     288.5GB
    /John/Downloads 77.0GB        75%        11.5GB     65.5GB</pre>
</div>
</div>
<div class="paragraph">
<p>Disk usage for volume test-volume as seen on client1:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    # df -hT /home
    Filesystem           Type            Size  Used Avail Use% Mounted on
    server1:/test-volume fuse.glusterfs  400G   12G  389G   3% /home</pre>
</div>
</div>
<div class="paragraph">
<p>The following example displays the disk usage when quota-deem-statfs is
on:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    # gluster volume set test-volume features.quota-deem-statfs on
    volume set: success
    # gluster vol quota test-volume list
    Path        Hard-limit    Soft-limit     Used     Available
    -----------------------------------------------------------
    /              300.0GB        90%        11.5GB     288.5GB
    /John/Downloads 77.0GB        75%        11.5GB     65.5GB</pre>
</div>
</div>
<div class="paragraph">
<p>Disk usage for volume test-volume as seen on client1:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    # df -hT /home
    Filesystem            Type            Size  Used Avail Use% Mounted on
    server1:/test-volume  fuse.glusterfs  300G   12G  289G   4% /home</pre>
</div>
</div>
<div class="paragraph">
<p>The quota-deem-statfs option when set to on, allows the administrator to
make the user view the total disk space available on the directory as
the hard limit set on it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="updating-memory-cache-size"><a class="anchor" href="#updating-memory-cache-size"></a>Updating Memory Cache Size</h3>
<div class="sect3">
<h4 id="setting-timeout"><a class="anchor" href="#setting-timeout"></a>Setting Timeout</h4>
<div class="paragraph">
<p>For performance reasons, quota caches the directory sizes on client. You
can set timeout indicating the maximum valid duration of directory sizes
in cache, from the time they are populated.</p>
</div>
<div class="paragraph">
<p>For example: If there are multiple clients writing to a single
directory, there are chances that some other client might write till the
quota limit is exceeded. However, this new file-size may not get
reflected in the client till size entry in cache has become stale
because of timeout. If writes happen on this client during this
duration, they are allowed even though they would lead to exceeding of
quota-limits, since size in cache is not in sync with the actual size.
When timeout happens, the size in cache is updated from servers and will
be in sync and no further writes will be allowed. A timeout of zero will
force fetching of directory sizes from server for every operation that
modifies file data and will effectively disables directory size caching
on client side.</p>
</div>
<div class="paragraph">
<p><strong>To update the memory cache size:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the following command to update the memory cache size:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume set  features.quota-timeout</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to update the memory cache size for every 5 seconds on
test-volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume set test-volume features.quota-timeout 5
Set volume successful</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="setting-alert-time"><a class="anchor" href="#setting-alert-time"></a>Setting Alert Time</h3>
<div class="paragraph">
<p>Alert time is the frequency at which you want your usage information to
be logged after you reach the soft limit.</p>
</div>
<div class="paragraph">
<p><strong>To set the alert time:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the following command to set the alert time:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota VOLNAME alert-time time</pre>
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>The default alert-time is one week.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>For example, to set the alert time to one day:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume alert-time 1d
volume quota : success</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="removing-disk-limit"><a class="anchor" href="#removing-disk-limit"></a>Removing Disk Limit</h3>
<div class="paragraph">
<p>You can remove set disk limit, if you do not want quota anymore.</p>
</div>
<div class="paragraph">
<p><strong>To remove disk limit:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the following command to remove the disk limit set on a particular
directory:</p>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota  remove</pre>
</div>
</div>
<div class="paragraph">
<p>For example, to remove the disk limit on /data directory of test-volume:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># gluster volume quota test-volume remove /data
Usage limit set on /data is removed</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
   <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
   <!-- Latest compiled and minified JavaScript -->
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
   <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
</body>
</html>